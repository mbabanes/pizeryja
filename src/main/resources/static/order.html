<!DOCTYPE html>
<html>
<script src="https://code.jquery.com/jquery-2.2.4.js" charset="utf-8"></script>
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="style/order.css">
<style>
</style>
<body>

<div class="container2">

	<header>
		<img src="images/baner.png" alt="baner" class="baner">
	</header>
	<div class="cart">
		<h1 style="font-weight: bold;">Cart:</h1>

		<p class="cartlist" id="cart"></p>
		<p class="price" id="price">Price: 0$</p>
		<button class="button" onclick="document.getElementById('id01').style.display='block'" >Finaliz</button>
		<br/>
		<button class="cancelbtn" onclick="claercard()">Claer Card</button>
	</div>
	<div class="wrapper">
		<div class="box a">
			<h2 id="pizza11">
				Margerita
			</h2>


			<img src="images/p1.png" alt="pizzaimg" class="pizzaimg">
			<div id="components11" class="boxbox">
				TOMATO SAUCE<br>
				CHEESE<br>
				OREGANO<br>
			</div>


			<div class="add">
				<form action="#n" name="theForm">

					<label class="container">Smal - 16$
						<input id="pizza12" type="radio" checked="checked" name="Margerita" value="small">
						<span class="checkmark"></span>
					</label>
					<label class="container">Mid - 20$
						<input id="pizza13" type="radio" name="Margerita" value="mid">
						<span class="checkmark"></span>
					</label>
					<label class="container">Large - 25$
						<input id="pizza14" type="radio" name="Margerita" value="large">
						<span class="checkmark"></span>
					</label>
				</form>

				<button class="w3-button w3-circle w3-teal" onclick="myFunction('Szynkowa')">Add</button>
			</div>
		</div>
		<div class="box b">
			<h2 id="pizza21">
				Capriciosa
			</h2>
			<img src="images/p2.png" alt="pizzaimg" class="pizzaimg">
			<div id="components21" class="boxbox">
				TOMATO SAUCE<br>
				CHEESE<br>
				HAM<br>
				MUSHROMS<br>
			</div>
			<div class="add">
				<form action="#n" name="theForm">

					<label class="container">Smal - 16$
						<input id="pizza22" type="radio" checked="checked" name="Caprisiosa" value="small">
						<span class="checkmark"></span>
					</label>
					<label class="container">Mid - 20$
						<input id="pizza23" type="radio" name="Caprisiosa" value="mid">
						<span class="checkmark"></span>
					</label>
					<label class="container">Large - 25$
						<input id="pizza24" type="radio" name="Caprisiosa" value="large">
						<span class="checkmark"></span>
					</label>
				</form>
				<button class="w3-button w3-circle w3-teal" onclick="myFunction('Bekonowa')">Add</button>
			</div>
		</div>
		<div class="box c">
			<h2 id="pizza31">
				Havana
			</h2>
			<img src="images/p3.png" alt="pizzaimg" class="pizzaimg">
			<div id="components31" class="boxbox">
				TOMATO<br>
				CHEESE<br>
				SALAMI<br>
				ONION<br>
			</div>
			<div class="add">
				<form action="#n" name="theForm">

					<label class="container">Smal - 16$
						<input id="pizza32" type="radio" checked="checked" name="Havana" value="small">
						<span class="checkmark"></span>
					</label>
					<label class="container">Mid - 20$
						<input id="pizza33" type="radio" name="Havana" value="mid">
						<span class="checkmark"></span>
					</label>
					<label class="container">Large - 25$
						<input id="pizza34" type="radio" name="Havana" value="large">
						<span class="checkmark"></span>
					</label>
				</form>
				<button class="w3-button w3-circle w3-teal" onclick="myFunction('mozzarella')">Add</button>
			</div>
		</div>


	</div>

</div>
<div id="id01" class="modal">

	<form class="modal-content animate" action="/action_page.php">
		<div class="imgcontainer">
			<span onclick="document.getElementById('id01').style.display='none'" class="close" title="Close Modal">&times;</span>
			<img src="images/logo.png" alt="Avatar" class="avatar">
		</div>
		<div style="background-color:#f1f1f1">
			<h2>Your order:</h2>

			<div class="right">
				<p class="cartlist" id="order_list"></p>
				<p class="price" id="fianl_price">Price: 0$</p>
			</div>
			<div class="">
				<label><h2>Delivery Address:</h2></label>
				<input id="addrCity" type="text" placeholder="City" name="addrCity" required>
				<input id="addrStr" type="text" placeholder="Street" name="addrStr" required>
				<input id="addrHN" type="text" placeholder="House number" name="addrHN" required>
			</div>
		</div>
		<div class="container" >
			<button type="button" onclick="finalize()" id="order_btn" disabled="disabled" class="button">I order!</button>

		</div>
	</form>
</div>
</div>
<script type="text/javascript">
    var modal = document.getElementById('id01');

    window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
    }

    var pizza = [];
    var pizzaCode = [];
    document.getElementById("cart").innerHTML = pizza;
    var price = 0;

    function myFunction(name) {

        var radios = document.getElementsByName(name);
        for (var i = 0, length = radios.length; i < length; i++)
        {
            if (radios[i].checked)
            {
                if(radios[i].value == "small"){
                    pizza.push("<br>"+name+" "+radios[i].value+" - 16$");
                    pizzaCode.push(name+" "+radios[i].value);
                    document.getElementById("cart").innerHTML = pizza;
                    document.getElementById("order_list").innerHTML = pizza;
                    price = price + 16;
                    document.getElementById("price").innerHTML ="Price: "+ price +"$";
                    document.getElementById("fianl_price").innerHTML ="Price: "+ price +"$";
                    document.getElementById("order_btn").disabled = false;
                }else if(radios[i].value == "mid"){
                    pizza.push("<br>"+name+" "+radios[i].value+" - 20$");
                    pizzaCode.push(name+" "+radios[i].value);
                    document.getElementById("order_list").innerHTML = pizza;
                    document.getElementById("cart").innerHTML = pizza;
                    price = price + 20;
                    document.getElementById("price").innerHTML ="Price: "+ price +"$";
                    document.getElementById("fianl_price").innerHTML ="Price: "+ price +"$";
                    document.getElementById("order_btn").disabled = false;
                }else if(radios[i].value == "large"){
                    pizza.push("<br>"+name+" "+radios[i].value+" - 25$");
                    pizzaCode.push(name+" "+radios[i].value);
                    document.getElementById("order_list").innerHTML = pizza;
                    document.getElementById("cart").innerHTML = pizza;
                    price = price + 25;
                    document.getElementById("price").innerHTML ="Price: "+ price +"$";
                    document.getElementById("fianl_price").innerHTML ="Price: "+ price +"$";
                    document.getElementById("order_btn").disabled = false;
                }
                break;
            }
        }


    };
    function claercard(){
        price=0;
        pizza=[];
        document.getElementById("order_list").innerHTML = pizza;
        document.getElementById("cart").innerHTML = pizza;
        document.getElementById("price").innerHTML ="Price: "+ price +"$";
        document.getElementById("order_btn").disabled = true;
        pizzaCode = [];
    };
    function final_order(){
        alert(""+pizzaCode);
    };
	var counter = "";
    var comp = ['components11', 'components21', 'components31'];

    $(document).ready(function() {


        $.ajax({
            url: "http://localhost:8080/pizza/all"
        }).then(function(data) {
            document.getElementById("pizza11").innerHTML = data[0].name;
            document.getElementById("pizza12").name = data[0].name;
            document.getElementById("pizza13").name = data[0].name;
            document.getElementById("pizza14").name = data[0].name;

            document.getElementById("pizza21").innerHTML = data[1].name;
            document.getElementById("pizza22").name = data[1].name;
            document.getElementById("pizza23").name = data[1].name;
            document.getElementById("pizza24").name = data[1].name;

            document.getElementById("pizza31").innerHTML = data[2].name;
            document.getElementById("pizza32").name = data[2].name;
            document.getElementById("pizza33").name = data[2].name;
            document.getElementById("pizza34").name = data[2].name;
            console.log(data[0].components);
            for (var j = 0; j < data.length; j++) {
                counter = "";
                for (var i = 0; i < data[j].components.length; i++) {
                    counter = counter + data[j].components[i].name + "</br>";
                }
                document.getElementById(comp[j]).innerHTML = counter;
            }



        });
    });

var pizzaIds = [1,2,1];
    function finalize() {

        $.ajax({
            type: "POST",
            url: '/order/make',
            dataType: 'json',
            data: JSON.stringify( {
                "addressJSON": {
                    "city": document.getElementById("addrCity").value,
                    "houseNumber": document.getElementById("addrHN").value,
                    "street": document.getElementById("addrStr").value,
                },
                "pizzaIds": pizzaIds
            }),
            contentType: 'application/json'

        })
        alert("Zakupy poprawne!");
        location.href = "http://localhost:8080/wait.html";
    };



</script>


</body>
</html>
